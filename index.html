<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tennis for Two — Game</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>Tennis for Two</h1>
    <div class="info">
      <div class="score">
        <span id="score-left">0</span>
        <span>:</span>
        <span id="score-right">0</span>
      </div>
      <div class="controls">Controls: W/S = left paddle, ↑/↓ = right paddle. Space = Start/Pause. R = Reset</div>
    </div>

    <canvas id="game" width="800" height="450" aria-label="Tennis for Two game canvas"></canvas>

    <div class="buttons">
      <button id="start">Start / Pause</button>
      <button id="reset">Reset</button>
      <button id="connect">Play on LAN</button>
    </div>

    <footer>
      <small>Keyboard controls recommended. Works on desktop browsers.</small>
    </footer>
  </div>

  <script>
    // Dynamic loader for Socket.IO client: try CDN first, then fall back to server endpoint
    (function(){
      function loadScript(src, onload, onerror){
        var s = document.createElement('script');
        s.src = src;
        s.async = false;
        s.onload = onload;
        s.onerror = onerror;
        document.head.appendChild(s);
      }

      var host = window.location.hostname || 'localhost';
      var triedServer = false;

      loadScript('https://cdn.socket.io/4.7.2/socket.io.min.js', function(){
        console.log('Loaded socket.io from CDN');
      }, function(){
        console.warn('CDN socket.io failed, trying server fallback');
        // try server fallback (socket.io serves client at /socket.io/socket.io.js)
        triedServer = true;
        loadScript((window.location.protocol === 'https:' ? 'https://' : 'http://') + host + ':10002/socket.io/socket.io.js', function(){
          console.log('Loaded socket.io from server');
        }, function(){
          console.error('Failed to load socket.io client from CDN and server fallback');
          // let script.js detect missing io and show user-friendly message
        });
      });
    })();
  </script>
  <script src="script.js"></script>
</body>
</html>